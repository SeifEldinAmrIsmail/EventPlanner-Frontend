<div class="page">
  <div class="glow"></div>

  <section class="shell">
    <!-- Header -->
    <header class="hero">
      <div class="icon-bubble">ğŸ”</div>
      <div>
        <h1>Search events</h1>
        <p class="sub">Filter by keyword, date range, and role.</p>
      </div>
    </header>

    <!-- Filters -->
    <form class="panel glass" [formGroup]="form" role="search" (ngSubmit)="submit()">
      <div class="filters">
        <!-- Keyword (no inner white button) -->
        <label class="field">
          <span class="label">Keywords</span>
          <div class="input">
            <span class="i">âŒ•</span>
            <input formControlName="q" type="text" placeholder="title, locationâ€¦" />
          </div>
        </label>

        <!-- Dates -->
        <div class="dates">
          <label class="field">
            <span class="label">From</span>
            <div class="input">
              <span class="i">ğŸ“…</span>
              <input formControlName="date_from" type="date" />
            </div>
          </label>

          <label class="field">
            <span class="label">To</span>
            <div class="input">
              <span class="i">ğŸ“…</span>
              <input formControlName="date_to" type="date" />
            </div>
          </label>
        </div>

        <!-- Role chips + actions -->
        <div class="chips" aria-label="Role">
          <button type="button" class="chip" [class.active]="form.value.role==='all'" (click)="setRole('all')">All</button>
          <button type="button" class="chip" [class.active]="form.value.role==='organizer'" (click)="setRole('organizer')">Organizer</button>
          <button type="button" class="chip" [class.active]="form.value.role==='attendee'" (click)="setRole('attendee')">Attendee</button>

          <div class="spacer"></div>
          <button type="button" class="btn ghost" (click)="clear()">Clear</button>
          <button type="submit" class="btn primary">Search</button>
        </div>
      </div>

      <div class="alert error" *ngIf="error">{{ error }}</div>
    </form>

    <!-- Results -->
    <section *ngIf="results.length; else empty">
      <div class="result-head">
        <span class="count-dot"></span>
        <p class="count">Found <b>{{ results.length }}</b> {{ results.length === 1 ? 'result' : 'results' }}</p>
      </div>

      <div class="grid">
        <article class="card" *ngFor="let e of results">
          <div class="glow-bar"></div>

          <div class="leading">
            <div class="bubble">ğŸ—“ï¸</div>
          </div>

          <div class="content">
            <div class="title" [innerHTML]="highlight(e.title)"></div>
            <div class="meta">
              <span class="pill"><span class="i">ğŸ“…</span>{{ e.date | date:'EEE, MMM d' }}</span>
              <span class="pill" *ngIf="e.time"><span class="i">â°</span>{{ e.time }}</span>
              <span class="pill" *ngIf="e.location"><span class="i">ğŸ“</span>{{ e.location }}</span>
              <span class="pill dim" *ngIf="$any(e).role">â€¢ {{$any(e).role}}</span>
            </div>
          </div>

          <div class="actions">
            <a class="btn small view" [routerLink]="['/events', e.id]">View</a>
          </div>
        </article>
      </div>
    </section>

    <ng-template #empty>
      <div class="empty glass">
        <div class="empty-icon">âœ¨</div>
        <p>No matching events.</p>
      </div>
    </ng-template>
  </section>
</div>
